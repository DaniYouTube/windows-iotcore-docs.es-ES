---
title: Protocolo de transferencia de medios
author: PawelWMS
ms.author: pawelwi
ms.date: 12/06/2017
ms.topic: article
description: Obtenga información acerca de cómo habilitar la característica opcional de protocolo de transferencia multimedia (MTP) para transferir archivos desde y hacia los dispositivos a través de USB.
keywords: Windows IOT, MTP, protocolo de transferencia multimedia, transferencia de archivos, dispositivos
ms.openlocfilehash: 72856617c8d49a1b06eadd13ab5fb085340d2ed4
ms.sourcegitcommit: 2b4ce105834c294dcdd8f332ac8dd2732f4b5af8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "60168043"
---
# <a name="media-transfer-protocol"></a><span data-ttu-id="f3ba4-104">Protocolo de transferencia de medios</span><span class="sxs-lookup"><span data-stu-id="f3ba4-104">Media Transfer Protocol</span></span>
<span data-ttu-id="f3ba4-105">El protocolo de transferencia multimedia (MTP) permite transferir archivos hacia y desde el dispositivo de Windows 10 IoT Core a través de USB.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-105">The Media Transfer Protocol (MTP) allows you to transfer files to and from your Windows 10 IoT Core device through USB.</span></span> <span data-ttu-id="f3ba4-106">Permite el acceso al almacenamiento interno del dispositivo y a la tarjeta SD, si está presente.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-106">It allows access to the device's internal storage and the SD card, if present.</span></span>

<span data-ttu-id="f3ba4-107">La característica forma parte de los kits de IoT Core, que se pueden descargar e instalar desde los [paquetes de Windows 10 IOT Core](https://www.microsoft.com/en-us/download/details.aspx?id=55031).</span><span class="sxs-lookup"><span data-stu-id="f3ba4-107">The feature is part of the IoT Core Kits, which can be downloaded and installed from the [Windows 10 IoT Core Packages](https://www.microsoft.com/en-us/download/details.aspx?id=55031).</span></span>

## <a name="how-to-install-the-mtp-feature-on-a-device-running-windows-10-iot-core"></a><span data-ttu-id="f3ba4-108">Cómo instalar la característica MTP en un dispositivo que ejecuta Windows 10 IoT Core</span><span class="sxs-lookup"><span data-stu-id="f3ba4-108">How to install the MTP feature on a device running Windows 10 IoT Core</span></span>

### <a name="provisioning-the-device-with-required-packages"></a><span data-ttu-id="f3ba4-109">Aprovisionamiento del dispositivo con los paquetes necesarios</span><span class="sxs-lookup"><span data-stu-id="f3ba4-109">Provisioning the device with required packages</span></span>

1. <span data-ttu-id="f3ba4-110">Inicie [PowerShell](../connect-your-device/PowerShell.md) o [ssh](../connect-your-device/SSH.md) y acceda a su dispositivo con Windows 10 IOT Core.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-110">Launch [Powershell](../connect-your-device/PowerShell.md) or [SSH](../connect-your-device/SSH.md) and access your device running Windows 10 IoT Core.</span></span>
2. <span data-ttu-id="f3ba4-111">En PowerShell o SSH, haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f3ba4-111">From Powershell or SSH, do the following:</span></span>
    1. <span data-ttu-id="f3ba4-112">Cree una carpeta temporal en el equipo de destino (por `C:\MTPTemp`ejemplo,).</span><span class="sxs-lookup"><span data-stu-id="f3ba4-112">Create a temporary folder on the target machine (e.g. `C:\MTPTemp`).</span></span>
    2. <span data-ttu-id="f3ba4-113">En función de la arquitectura del dispositivo, copie los siguientes paquetes desde su PC`C:\Program Files (x86)\Windows Kits\10\MSPackages\Retail\<arch>\fre`() `C:\MTPTemp`a:</span><span class="sxs-lookup"><span data-stu-id="f3ba4-113">Based on your device's architecture, copy the following packages from your PC (`C:\Program Files (x86)\Windows Kits\10\MSPackages\Retail\<arch>\fre`) to `C:\MTPTemp`:</span></span>
        * `Microsoft-OneCoreUAP-Mtp-UserService-Package.cab`
        * `Microsoft-OneCoreUAP-Mtp-UserService-Package_Lang_en-US.cab`
        * `Microsoft-WindowsStorSvc-API-Schema-Extension-Package.cab`
        * `Microsoft-WindowsStorSvc-API-Schema-Extension-Package_Lang_en-US.cab`
    3. <span data-ttu-id="f3ba4-114">Ejecute estos comandos desde `C:\MTPTemp` para instalar los paquetes en la imagen del sistema de su dispositivo IOT:</span><span class="sxs-lookup"><span data-stu-id="f3ba4-114">Run these commands from `C:\MTPTemp` to install the packages to your IoT device's system image:</span></span>
        * `ApplyUpdate.exe -stage Microsoft-OneCoreUAP-Mtp-UserService-Package.cab`
        * `ApplyUpdate.exe -stage Microsoft-OneCoreUAP-Mtp-UserService-Package_Lang_en-US.cab`
        * `ApplyUpdate.exe -stage Microsoft-WindowsStorSvc-API-Schema-Extension-Package.cab`
        * `ApplyUpdate.exe -stage Microsoft-WindowsStorSvc-API-Schema-Extension-Package_Lang_en-US.cab`
        * `ApplyUpdate.exe -commit`
3. <span data-ttu-id="f3ba4-115">El dispositivo arrancará en el sistema operativo de actualización, instalará la característica MTP y se reiniciará en el archivo principal.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-115">The device will boot to the Update OS, install the MTP feature, and reboot to the MainOS.</span></span>

### <a name="enabling-the-mtp-usb-interface"></a><span data-ttu-id="f3ba4-116">Habilitación de la interfaz USB MTP</span><span class="sxs-lookup"><span data-stu-id="f3ba4-116">Enabling the MTP USB interface</span></span>

<span data-ttu-id="f3ba4-117">Una vez que el dispositivo vuelve a los principales, la configuración de USBFN todavía debe actualizarse para incluir MTP.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-117">Once the device comes back to the MainOS, the USBFN configuration still needs to be updated to include MTP.</span></span> <span data-ttu-id="f3ba4-118">Para ello, tendrá que agregar MTP a las interfaces enumeradas por USBFN.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-118">In order to do that, you will need to add MTP to the interfaces enumerated by USBFN.</span></span>
<span data-ttu-id="f3ba4-119">En el artículo [configuración del registro USB](https://docs.microsoft.com/windows-hardware/drivers/usbcon/usb-registry-settings-for-a-function-controller-driver) se explican los detalles de la configuración de USB.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-119">The [USB registry settings](https://docs.microsoft.com/windows-hardware/drivers/usbcon/usb-registry-settings-for-a-function-controller-driver) article explains the details of USB's configuration.</span></span>

<span data-ttu-id="f3ba4-120">Aunque puede modificar la configuración predeterminada de USBFN disponible en la `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default` clave, se recomienda definir la suya propia, ya que las actualizaciones del sistema no sobrescribirán.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-120">While you can modify the default USBFN configuration available under the `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default` key, it is recommended to define your own, as they will not get overwritten by system updates.</span></span>

#### <a name="creating-a-new-usbfn-configuration-with-the-mtp-interface"></a><span data-ttu-id="f3ba4-121">Creación de una nueva configuración de USBFN con la interfaz MTP</span><span class="sxs-lookup"><span data-stu-id="f3ba4-121">Creating a new USBFN configuration with the MTP interface</span></span>

<span data-ttu-id="f3ba4-122">Siga estos pasos para agregar una nueva configuración con MTP:</span><span class="sxs-lookup"><span data-stu-id="f3ba4-122">Follow these steps to add a new configuration with MTP:</span></span>
1. <span data-ttu-id="f3ba4-123">Agregue una nueva clave en `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations`.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-123">Add a new key under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations`.</span></span> <span data-ttu-id="f3ba4-124">Ejemplo: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\MyConfiguration`.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-124">Example: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\MyConfiguration`.</span></span>
2. <span data-ttu-id="f3ba4-125">En la nueva clave, cree `REG_MULTI_SZ` un `InterfaceList` valor igual `MTP`a.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-125">Under the new key create a `REG_MULTI_SZ` value `InterfaceList` equal to `MTP`.</span></span>
3. <span data-ttu-id="f3ba4-126">En la misma clave, cree `REG_BINARY` un `MSOSCompatIdDescriptor` valor igual `2800000000010400010000000000000000014D545000000000000000000000000000000000000000`a.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-126">Under the same key create a `REG_BINARY` value `MSOSCompatIdDescriptor` equal to `2800000000010400010000000000000000014D545000000000000000000000000000000000000000`.</span></span>
4. <span data-ttu-id="f3ba4-127">En `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` agregue un nuevo `REG_SZ` valor `CurrentConfiguration` igual al nombre de la clave recién creada.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-127">Under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` add a new `REG_SZ` value `CurrentConfiguration` equal to the name of the newly created key.</span></span> <span data-ttu-id="f3ba4-128">En este caso, sería `MyConfiguration`.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-128">In this case it would be `MyConfiguration`.</span></span>
5. <span data-ttu-id="f3ba4-129">[**Opcional**] En `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` , agregue un `REG_DWORD` nuevo `IncludeDefaultCfg` valor igual a 1.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-129">[**Optional**] Under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` add a new `REG_DWORD` value `IncludeDefaultCfg` equal to 1.</span></span> <span data-ttu-id="f3ba4-130">Esto hará que el controlador USB enumere las interfaces predeterminadas junto con MTP.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-130">This will make the USB driver enumerate the default interfaces along with MTP.</span></span>

> [!NOTE]
> <span data-ttu-id="f3ba4-131">Si ya usa una configuración personalizada, tendrá que modificarla en lugar de crear una nueva.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-131">If you are already using a custom configuration you will have to modify it instead of creating a new one.</span></span>

#### <a name="adding-the-mtp-interface-to-an-existing-configuration"></a><span data-ttu-id="f3ba4-132">Agregar la interfaz MTP a una configuración existente</span><span class="sxs-lookup"><span data-stu-id="f3ba4-132">Adding the MTP interface to an existing configuration</span></span>

<span data-ttu-id="f3ba4-133">Siga estos pasos para agregar MTP a una configuración de USBFN existente:</span><span class="sxs-lookup"><span data-stu-id="f3ba4-133">Follow these steps to add MTP to an existing USBFN configuration:</span></span>
1. <span data-ttu-id="f3ba4-134">Busque la configuración actual comprobando el `CurrentConfiguration` valor en `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN`.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-134">Find the current configuration by checking the `CurrentConfiguration` value under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN`.</span></span> <span data-ttu-id="f3ba4-135">Si el valor está presente, la configuración actual se puede encontrar en `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\[CurrentConfiguration]`.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-135">If the value is present, then the current configuration can be found under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\[CurrentConfiguration]`.</span></span> <span data-ttu-id="f3ba4-136">En caso contrario, `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default`está en.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-136">Otherwise it is under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default`.</span></span>
2. <span data-ttu-id="f3ba4-137">En la clave de configuración actual `\0MTP` , agregue al valor `InterfaceList`de.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-137">Under the current configuration key add `\0MTP` to the value of `InterfaceList`.</span></span> <span data-ttu-id="f3ba4-138">La parte ***\ 0*** se usa como el tipo de `InterfaceList` is `REG_MULTI_SZ` y requiere este separador entre los valores.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-138">The ***\0*** part is used as the type of `InterfaceList` is `REG_MULTI_SZ` and it requires this separator between values.</span></span>
3. <span data-ttu-id="f3ba4-139">Modifique el `MSOSCompatIdDescriptor` valor para incluir el descriptor de MTP.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-139">Modify the `MSOSCompatIdDescriptor` value to include the MTP's descriptor.</span></span> <span data-ttu-id="f3ba4-140">Para crear un descriptor válido que contenga todas las interfaces `InterfaceList` actualmente bajo el valor, siga la documentación de instrucciones disponible en la parte inferior de [esta página](https://msdn.microsoft.com/windows/hardware/gg463179.aspx).</span><span class="sxs-lookup"><span data-stu-id="f3ba4-140">In order to create a valid descriptor containing all interfaces currently under the `InterfaceList` value, please follow the instructions documentation available at the bottom of [this page](https://msdn.microsoft.com/windows/hardware/gg463179.aspx).</span></span> <span data-ttu-id="f3ba4-141">*OS_Desc_CompatID. doc* proporciona una explicación del formato del descriptor y un ejemplo de cómo incluir varias interfaces en el descriptor.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-141">*OS_Desc_CompatID.doc* gives an explanation of the descriptor's format and an example of including multiple interfaces in the descriptor.</span></span> <span data-ttu-id="f3ba4-142">Los identificadores compatibles y subcompatibles de MTP también están disponibles en la misma página y se usan en uno de los ejemplos.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-142">MTP's compatible and sub-compatible IDs are also available on the same page and are used in one of the examples.</span></span>

## <a name="how-to-include-mtp-in-your-custom-ffu"></a><span data-ttu-id="f3ba4-143">Cómo incluir MTP en el FFU personalizado</span><span class="sxs-lookup"><span data-stu-id="f3ba4-143">How to include MTP in Your Custom FFU</span></span>

1. <span data-ttu-id="f3ba4-144">Agregue el identificador de la característica **IOT_MTP** al archivo de entrada OEM.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-144">Add **IOT_MTP** feature ID to the OEM Input file.</span></span> <span data-ttu-id="f3ba4-145">Este es un equivalente a seguir los pasos de la sección "[**aprovisionar el dispositivo con los paquetes necesarios**](#provisioning-the-device-with-required-packages)".</span><span class="sxs-lookup"><span data-stu-id="f3ba4-145">This is an equivalent of following the steps from the "[**Provisioning the device with required packages**](#provisioning-the-device-with-required-packages)" section.</span></span>
2. <span data-ttu-id="f3ba4-146">Asegúrese de aplicar los mismos cambios del registro que se mencionan en la sección "[**creación de una nueva configuración de USBFN con la interfaz MTP**](#creating-a-new-usbfn-configuration-with-the-mtp-interface)".</span><span class="sxs-lookup"><span data-stu-id="f3ba4-146">Make sure to apply the same registry changes as mentioned in the "[**Creating a new USBFN configuration with the MTP interface**](#creating-a-new-usbfn-configuration-with-the-mtp-interface)" section.</span></span> <span data-ttu-id="f3ba4-147">Siga [estas instrucciones](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) para obtener información sobre cómo aplicar cambios del registro a un FFU.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-147">Follow [these instructions](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) to learn how to apply registry changes to an FFU.</span></span>
3. <span data-ttu-id="f3ba4-148">Crear image\FFU.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-148">Create the image\FFU.</span></span> <span data-ttu-id="f3ba4-149">Lea [este artículo](https://docs.microsoft.com/windows-hardware/manufacture/iot/create-a-basic-image) para obtener instrucciones.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-149">Read [this article](https://docs.microsoft.com/windows-hardware/manufacture/iot/create-a-basic-image) for instructions.</span></span>

> [!WARNING]
> <span data-ttu-id="f3ba4-150">No se debe intentar modificar la configuración predeterminada mediante la personalización de FFU.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-150">Modifying the default configuration should not be attempted through FFU customization.</span></span> <span data-ttu-id="f3ba4-151">Las entradas definidas por el sistema pueden ser actualizadas o modificadas por una actualización del sistema y se perderán todas las configuraciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-151">System-defined entries may be refreshed/changed by a system update and any custom settings will be lost.</span></span>

## <a name="how-to-setup-the-mtp-sd-card-filter"></a><span data-ttu-id="f3ba4-152">Configuración del filtro de tarjeta SD MTP</span><span class="sxs-lookup"><span data-stu-id="f3ba4-152">How to setup the MTP SD card filter</span></span>

<span data-ttu-id="f3ba4-153">De forma predeterminada, MTP enumerará todo el contenido de una tarjeta SD, si está presente en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-153">By default MTP will enumerate all of the contents of an SD card, if it is present on the device.</span></span> <span data-ttu-id="f3ba4-154">Sin embargo, es posible limitar esta enumeración a una subcarpeta específica.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-154">It is possible, however, to limit this enumeration to a specific subfolder.</span></span> <span data-ttu-id="f3ba4-155">Para ello, debe agregar un valor `MTPSDFolderFilter` del registro en la clave `HKEY_LOCAL_MACHINE\Software\Microsoft\MTP`del registro.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-155">In order to do so, you must add a registry value `MTPSDFolderFilter` under the registry key `HKEY_LOCAL_MACHINE\Software\Microsoft\MTP`.</span></span>
<span data-ttu-id="f3ba4-156">El valor es de tipo `REG_SZ` y debe contener una ruta de acceso relativa a la carpeta que desea que la Enumere MTP.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-156">The value is of type `REG_SZ` and should contain a relative path to the folder you would like MTP to enumerate.</span></span> <span data-ttu-id="f3ba4-157">La carpeta se creará automáticamente si aún no existe.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-157">The folder will get automatically created if it does not already exist.</span></span>

<span data-ttu-id="f3ba4-158">Rutas de acceso de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f3ba4-158">Sample paths:</span></span>
- <span data-ttu-id="f3ba4-159">\FirstLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="f3ba4-159">\FirstLevelDirectory;</span></span>
- <span data-ttu-id="f3ba4-160">FirstLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="f3ba4-160">FirstLevelDirectory;</span></span>
- <span data-ttu-id="f3ba4-161">\FirstLevelDirectory\SecondLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="f3ba4-161">\FirstLevelDirectory\SecondLevelDirectory;</span></span>
- <span data-ttu-id="f3ba4-162">Never\Before\Created\Directory.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-162">Never\Before\Created\Directory.</span></span>

> [!WARNING]
> <span data-ttu-id="f3ba4-163">No use una ruta de acceso absoluta que contenga la `C:\Some\Folder\Path` letra de la unidad, como-esto podría impedir que se Enumere la tarjeta SD.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-163">Do not use an absolute path containing the drive letter like `C:\Some\Folder\Path` - this might prevent the SD card from being enumerated.</span></span>

<span data-ttu-id="f3ba4-164">Consulte [este vínculo](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) para obtener más información sobre cómo personalizar la imagen con entradas específicas del registro.</span><span class="sxs-lookup"><span data-stu-id="f3ba4-164">See [this link](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) for details about customizing your image with specific registry entries.</span></span>

---
title: Protocolo de transferencia multimedia
author: PawelWMS
ms.author: pawelwi
ms.date: 12/06/2017
ms.topic: article
description: Obtenga información sobre cómo habilitar la característica opcional de protocolo de transferencia multimedia (MTP) transferir archivos a y desde los dispositivos a través de USB.
keywords: medios de Windows iot, MTP, transferencia de protocolo de transferencia de archivos, los dispositivos
ms.openlocfilehash: 72856617c8d49a1b06eadd13ab5fb085340d2ed4
ms.sourcegitcommit: ef85ccba54b1118d49554e88768240020ff514b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/11/2019
ms.locfileid: "59514263"
---
# <a name="media-transfer-protocol"></a><span data-ttu-id="1b106-104">Protocolo de transferencia multimedia</span><span class="sxs-lookup"><span data-stu-id="1b106-104">Media Transfer Protocol</span></span>
<span data-ttu-id="1b106-105">El protocolo de transferencia multimedia (MTP) le permite transferir archivos a y desde el dispositivo Windows 10 IoT Core a través de USB.</span><span class="sxs-lookup"><span data-stu-id="1b106-105">The Media Transfer Protocol (MTP) allows you to transfer files to and from your Windows 10 IoT Core device through USB.</span></span> <span data-ttu-id="1b106-106">Permite el acceso al almacenamiento interno del dispositivo y la tarjeta SD, si está presente.</span><span class="sxs-lookup"><span data-stu-id="1b106-106">It allows access to the device's internal storage and the SD card, if present.</span></span>

<span data-ttu-id="1b106-107">La característica forma parte de los Kits de núcleo de IoT, que puede descargarse e instalarse desde el [los paquetes de Windows 10 IoT Core](https://www.microsoft.com/en-us/download/details.aspx?id=55031).</span><span class="sxs-lookup"><span data-stu-id="1b106-107">The feature is part of the IoT Core Kits, which can be downloaded and installed from the [Windows 10 IoT Core Packages](https://www.microsoft.com/en-us/download/details.aspx?id=55031).</span></span>

## <a name="how-to-install-the-mtp-feature-on-a-device-running-windows-10-iot-core"></a><span data-ttu-id="1b106-108">Cómo instalar la característica MTP en un dispositivo que ejecuta Windows 10 IoT Core</span><span class="sxs-lookup"><span data-stu-id="1b106-108">How to install the MTP feature on a device running Windows 10 IoT Core</span></span>

### <a name="provisioning-the-device-with-required-packages"></a><span data-ttu-id="1b106-109">Aprovisionamiento del dispositivo con los paquetes necesarios</span><span class="sxs-lookup"><span data-stu-id="1b106-109">Provisioning the device with required packages</span></span>

1. <span data-ttu-id="1b106-110">Iniciar [Powershell](../connect-your-device/PowerShell.md) o [SSH](../connect-your-device/SSH.md) y tener acceso a un dispositivo que ejecuta Windows 10 IoT Core.</span><span class="sxs-lookup"><span data-stu-id="1b106-110">Launch [Powershell](../connect-your-device/PowerShell.md) or [SSH](../connect-your-device/SSH.md) and access your device running Windows 10 IoT Core.</span></span>
2. <span data-ttu-id="1b106-111">Desde Powershell o SSH, realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="1b106-111">From Powershell or SSH, do the following:</span></span>
    1. <span data-ttu-id="1b106-112">Cree una carpeta temporal del equipo de destino (por ejemplo, `C:\MTPTemp`).</span><span class="sxs-lookup"><span data-stu-id="1b106-112">Create a temporary folder on the target machine (e.g. `C:\MTPTemp`).</span></span>
    2. <span data-ttu-id="1b106-113">Según la arquitectura del dispositivo, copie los siguientes paquetes desde su PC (`C:\Program Files (x86)\Windows Kits\10\MSPackages\Retail\<arch>\fre`) a `C:\MTPTemp`:</span><span class="sxs-lookup"><span data-stu-id="1b106-113">Based on your device's architecture, copy the following packages from your PC (`C:\Program Files (x86)\Windows Kits\10\MSPackages\Retail\<arch>\fre`) to `C:\MTPTemp`:</span></span>
        * `Microsoft-OneCoreUAP-Mtp-UserService-Package.cab`
        * `Microsoft-OneCoreUAP-Mtp-UserService-Package_Lang_en-US.cab`
        * `Microsoft-WindowsStorSvc-API-Schema-Extension-Package.cab`
        * `Microsoft-WindowsStorSvc-API-Schema-Extension-Package_Lang_en-US.cab`
    3. <span data-ttu-id="1b106-114">Ejecute estos comandos desde `C:\MTPTemp` para instalar los paquetes a la imagen de sistema de su dispositivo de IoT:</span><span class="sxs-lookup"><span data-stu-id="1b106-114">Run these commands from `C:\MTPTemp` to install the packages to your IoT device's system image:</span></span>
        * `ApplyUpdate.exe -stage Microsoft-OneCoreUAP-Mtp-UserService-Package.cab`
        * `ApplyUpdate.exe -stage Microsoft-OneCoreUAP-Mtp-UserService-Package_Lang_en-US.cab`
        * `ApplyUpdate.exe -stage Microsoft-WindowsStorSvc-API-Schema-Extension-Package.cab`
        * `ApplyUpdate.exe -stage Microsoft-WindowsStorSvc-API-Schema-Extension-Package_Lang_en-US.cab`
        * `ApplyUpdate.exe -commit`
3. <span data-ttu-id="1b106-115">El dispositivo arranque en el sistema operativo de la actualización, instale la característica MTP y para el MainOS reiniciar el equipo.</span><span class="sxs-lookup"><span data-stu-id="1b106-115">The device will boot to the Update OS, install the MTP feature, and reboot to the MainOS.</span></span>

### <a name="enabling-the-mtp-usb-interface"></a><span data-ttu-id="1b106-116">Habilitación de la interfaz de MTP USB</span><span class="sxs-lookup"><span data-stu-id="1b106-116">Enabling the MTP USB interface</span></span>

<span data-ttu-id="1b106-117">Una vez que el dispositivo vuelve a la MainOS, la configuración de USBFN debe actualizarse para incluir MTP.</span><span class="sxs-lookup"><span data-stu-id="1b106-117">Once the device comes back to the MainOS, the USBFN configuration still needs to be updated to include MTP.</span></span> <span data-ttu-id="1b106-118">Para ello, deberá agregar MTP a las interfaces enumeradas por USBFN.</span><span class="sxs-lookup"><span data-stu-id="1b106-118">In order to do that, you will need to add MTP to the interfaces enumerated by USBFN.</span></span>
<span data-ttu-id="1b106-119">El [configuración del registro USB](https://docs.microsoft.com/windows-hardware/drivers/usbcon/usb-registry-settings-for-a-function-controller-driver) artículo explica los detalles de configuración de USB.</span><span class="sxs-lookup"><span data-stu-id="1b106-119">The [USB registry settings](https://docs.microsoft.com/windows-hardware/drivers/usbcon/usb-registry-settings-for-a-function-controller-driver) article explains the details of USB's configuration.</span></span>

<span data-ttu-id="1b106-120">Aunque puede modificar la configuración predeterminada de USBFN disponible bajo la `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default` clave, se recomienda se definir las suyas propias, como no se sobrescriban por las actualizaciones del sistema.</span><span class="sxs-lookup"><span data-stu-id="1b106-120">While you can modify the default USBFN configuration available under the `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default` key, it is recommended to define your own, as they will not get overwritten by system updates.</span></span>

#### <a name="creating-a-new-usbfn-configuration-with-the-mtp-interface"></a><span data-ttu-id="1b106-121">Crear una nueva configuración de USBFN con la interfaz MTP</span><span class="sxs-lookup"><span data-stu-id="1b106-121">Creating a new USBFN configuration with the MTP interface</span></span>

<span data-ttu-id="1b106-122">Siga estos pasos para agregar una nueva configuración con MTP:</span><span class="sxs-lookup"><span data-stu-id="1b106-122">Follow these steps to add a new configuration with MTP:</span></span>
1. <span data-ttu-id="1b106-123">Agregue una nueva clave en `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations`.</span><span class="sxs-lookup"><span data-stu-id="1b106-123">Add a new key under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations`.</span></span> <span data-ttu-id="1b106-124">Ejemplo: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\MyConfiguration`.</span><span class="sxs-lookup"><span data-stu-id="1b106-124">Example: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\MyConfiguration`.</span></span>
2. <span data-ttu-id="1b106-125">En la nueva clave cree una `REG_MULTI_SZ` valor `InterfaceList` igual a `MTP`.</span><span class="sxs-lookup"><span data-stu-id="1b106-125">Under the new key create a `REG_MULTI_SZ` value `InterfaceList` equal to `MTP`.</span></span>
3. <span data-ttu-id="1b106-126">En la misma clave, cree un `REG_BINARY` valor `MSOSCompatIdDescriptor` igual a `2800000000010400010000000000000000014D545000000000000000000000000000000000000000`.</span><span class="sxs-lookup"><span data-stu-id="1b106-126">Under the same key create a `REG_BINARY` value `MSOSCompatIdDescriptor` equal to `2800000000010400010000000000000000014D545000000000000000000000000000000000000000`.</span></span>
4. <span data-ttu-id="1b106-127">En `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` agregar un nuevo `REG_SZ` valor `CurrentConfiguration` igual al nombre de la clave recién creada.</span><span class="sxs-lookup"><span data-stu-id="1b106-127">Under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` add a new `REG_SZ` value `CurrentConfiguration` equal to the name of the newly created key.</span></span> <span data-ttu-id="1b106-128">En este caso sería `MyConfiguration`.</span><span class="sxs-lookup"><span data-stu-id="1b106-128">In this case it would be `MyConfiguration`.</span></span>
5. <span data-ttu-id="1b106-129">[**Opcional**] bajo `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` agregar un nuevo `REG_DWORD` valor `IncludeDefaultCfg` igual a 1.</span><span class="sxs-lookup"><span data-stu-id="1b106-129">[**Optional**] Under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` add a new `REG_DWORD` value `IncludeDefaultCfg` equal to 1.</span></span> <span data-ttu-id="1b106-130">Esto hará que el controlador USB para enumerar las interfaces de forma predeterminada junto con MTP.</span><span class="sxs-lookup"><span data-stu-id="1b106-130">This will make the USB driver enumerate the default interfaces along with MTP.</span></span>

> [!NOTE]
> <span data-ttu-id="1b106-131">Si ya está usando una configuración personalizada, que tendrá que modificarla en lugar de crear uno nuevo.</span><span class="sxs-lookup"><span data-stu-id="1b106-131">If you are already using a custom configuration you will have to modify it instead of creating a new one.</span></span>

#### <a name="adding-the-mtp-interface-to-an-existing-configuration"></a><span data-ttu-id="1b106-132">Adición de la interfaz MTP a una configuración existente</span><span class="sxs-lookup"><span data-stu-id="1b106-132">Adding the MTP interface to an existing configuration</span></span>

<span data-ttu-id="1b106-133">Siga estos pasos para agregar MTP a una configuración USBFN existente:</span><span class="sxs-lookup"><span data-stu-id="1b106-133">Follow these steps to add MTP to an existing USBFN configuration:</span></span>
1. <span data-ttu-id="1b106-134">Busque la configuración actual mediante la comprobación de la `CurrentConfiguration` valor bajo `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN`.</span><span class="sxs-lookup"><span data-stu-id="1b106-134">Find the current configuration by checking the `CurrentConfiguration` value under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN`.</span></span> <span data-ttu-id="1b106-135">Si el valor está presente, se puede encontrar la configuración actual en `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\[CurrentConfiguration]`.</span><span class="sxs-lookup"><span data-stu-id="1b106-135">If the value is present, then the current configuration can be found under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\[CurrentConfiguration]`.</span></span> <span data-ttu-id="1b106-136">Si no se encuentra en `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default`.</span><span class="sxs-lookup"><span data-stu-id="1b106-136">Otherwise it is under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default`.</span></span>
2. <span data-ttu-id="1b106-137">En la clave de configuración actual, agregue `\0MTP` al valor de `InterfaceList`.</span><span class="sxs-lookup"><span data-stu-id="1b106-137">Under the current configuration key add `\0MTP` to the value of `InterfaceList`.</span></span> <span data-ttu-id="1b106-138">El ***\0*** parte se utiliza como el tipo de `InterfaceList` es `REG_MULTI_SZ` y requiere este separador entre los valores.</span><span class="sxs-lookup"><span data-stu-id="1b106-138">The ***\0*** part is used as the type of `InterfaceList` is `REG_MULTI_SZ` and it requires this separator between values.</span></span>
3. <span data-ttu-id="1b106-139">Modificar el `MSOSCompatIdDescriptor` valor para incluir el descriptor de MTP.</span><span class="sxs-lookup"><span data-stu-id="1b106-139">Modify the `MSOSCompatIdDescriptor` value to include the MTP's descriptor.</span></span> <span data-ttu-id="1b106-140">Para crear un descriptor válido que contiene todas las interfaces actualmente en el `InterfaceList` valor, siga la documentación de instrucciones disponible en la parte inferior de [esta página](https://msdn.microsoft.com/windows/hardware/gg463179.aspx).</span><span class="sxs-lookup"><span data-stu-id="1b106-140">In order to create a valid descriptor containing all interfaces currently under the `InterfaceList` value, please follow the instructions documentation available at the bottom of [this page](https://msdn.microsoft.com/windows/hardware/gg463179.aspx).</span></span> <span data-ttu-id="1b106-141">*OS_Desc_CompatID.doc* ofrece una explicación del formato del descriptor y un ejemplo de inclusión de varias interfaces en el descriptor.</span><span class="sxs-lookup"><span data-stu-id="1b106-141">*OS_Desc_CompatID.doc* gives an explanation of the descriptor's format and an example of including multiple interfaces in the descriptor.</span></span> <span data-ttu-id="1b106-142">Identificadores de Sub compatibles y compatibles de MTP también están disponibles en la misma página y se usan en uno de los ejemplos.</span><span class="sxs-lookup"><span data-stu-id="1b106-142">MTP's compatible and sub-compatible IDs are also available on the same page and are used in one of the examples.</span></span>

## <a name="how-to-include-mtp-in-your-custom-ffu"></a><span data-ttu-id="1b106-143">Cómo incluir MTP en su FFU personalizado</span><span class="sxs-lookup"><span data-stu-id="1b106-143">How to include MTP in Your Custom FFU</span></span>

1. <span data-ttu-id="1b106-144">Agregar **IOT_MTP** Id. de característica en el archivo de entrada de OEM.</span><span class="sxs-lookup"><span data-stu-id="1b106-144">Add **IOT_MTP** feature ID to the OEM Input file.</span></span> <span data-ttu-id="1b106-145">Esto es equivalente a seguir los pasos de la "[**aprovisionar el dispositivo con los paquetes necesarios**](#provisioning-the-device-with-required-packages)" sección.</span><span class="sxs-lookup"><span data-stu-id="1b106-145">This is an equivalent of following the steps from the "[**Provisioning the device with required packages**](#provisioning-the-device-with-required-packages)" section.</span></span>
2. <span data-ttu-id="1b106-146">Asegúrese de aplicar los mismos cambios del registro como se mencionó en la "[**crear una nueva configuración de USBFN con la interfaz MTP**](#creating-a-new-usbfn-configuration-with-the-mtp-interface)" sección.</span><span class="sxs-lookup"><span data-stu-id="1b106-146">Make sure to apply the same registry changes as mentioned in the "[**Creating a new USBFN configuration with the MTP interface**](#creating-a-new-usbfn-configuration-with-the-mtp-interface)" section.</span></span> <span data-ttu-id="1b106-147">Siga [estas instrucciones](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) para obtener información sobre cómo aplicar los cambios del registro a un FFU.</span><span class="sxs-lookup"><span data-stu-id="1b106-147">Follow [these instructions](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) to learn how to apply registry changes to an FFU.</span></span>
3. <span data-ttu-id="1b106-148">Cree el image\FFU.</span><span class="sxs-lookup"><span data-stu-id="1b106-148">Create the image\FFU.</span></span> <span data-ttu-id="1b106-149">Lectura [en este artículo](https://docs.microsoft.com/windows-hardware/manufacture/iot/create-a-basic-image) para obtener instrucciones.</span><span class="sxs-lookup"><span data-stu-id="1b106-149">Read [this article](https://docs.microsoft.com/windows-hardware/manufacture/iot/create-a-basic-image) for instructions.</span></span>

> [!WARNING]
> <span data-ttu-id="1b106-150">No se debe intentar modificar la configuración predeterminada mediante la personalización de FFU.</span><span class="sxs-lookup"><span data-stu-id="1b106-150">Modifying the default configuration should not be attempted through FFU customization.</span></span> <span data-ttu-id="1b106-151">Las entradas definidas por el sistema pueden actualizar o cambiar una actualización del sistema y se perderá cualquier configuración personalizada.</span><span class="sxs-lookup"><span data-stu-id="1b106-151">System-defined entries may be refreshed/changed by a system update and any custom settings will be lost.</span></span>

## <a name="how-to-setup-the-mtp-sd-card-filter"></a><span data-ttu-id="1b106-152">Cómo configurar el filtro de la tarjeta SD MTP</span><span class="sxs-lookup"><span data-stu-id="1b106-152">How to setup the MTP SD card filter</span></span>

<span data-ttu-id="1b106-153">De forma predeterminada MTP enumerará todo el contenido de una tarjeta SD, si está presente en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="1b106-153">By default MTP will enumerate all of the contents of an SD card, if it is present on the device.</span></span> <span data-ttu-id="1b106-154">Sin embargo, es posible limitar esta enumeración en una subcarpeta específica.</span><span class="sxs-lookup"><span data-stu-id="1b106-154">It is possible, however, to limit this enumeration to a specific subfolder.</span></span> <span data-ttu-id="1b106-155">Para ello, debe agregar un valor del registro `MTPSDFolderFilter` bajo la clave del registro `HKEY_LOCAL_MACHINE\Software\Microsoft\MTP`.</span><span class="sxs-lookup"><span data-stu-id="1b106-155">In order to do so, you must add a registry value `MTPSDFolderFilter` under the registry key `HKEY_LOCAL_MACHINE\Software\Microsoft\MTP`.</span></span>
<span data-ttu-id="1b106-156">El valor es de tipo `REG_SZ` y debe contener una ruta de acceso relativa a la carpeta que le gustaría MTP a enumerar.</span><span class="sxs-lookup"><span data-stu-id="1b106-156">The value is of type `REG_SZ` and should contain a relative path to the folder you would like MTP to enumerate.</span></span> <span data-ttu-id="1b106-157">La carpeta obtener creará automáticamente si aún no existe.</span><span class="sxs-lookup"><span data-stu-id="1b106-157">The folder will get automatically created if it does not already exist.</span></span>

<span data-ttu-id="1b106-158">Rutas de acceso de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="1b106-158">Sample paths:</span></span>
- <span data-ttu-id="1b106-159">\FirstLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="1b106-159">\FirstLevelDirectory;</span></span>
- <span data-ttu-id="1b106-160">FirstLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="1b106-160">FirstLevelDirectory;</span></span>
- <span data-ttu-id="1b106-161">\FirstLevelDirectory\SecondLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="1b106-161">\FirstLevelDirectory\SecondLevelDirectory;</span></span>
- <span data-ttu-id="1b106-162">Never\Before\Created\Directory.</span><span class="sxs-lookup"><span data-stu-id="1b106-162">Never\Before\Created\Directory.</span></span>

> [!WARNING]
> <span data-ttu-id="1b106-163">No use una ruta de acceso absoluta que contiene la letra de unidad como `C:\Some\Folder\Path` -Esto podría impedir que la tarjeta SD está enumerando.</span><span class="sxs-lookup"><span data-stu-id="1b106-163">Do not use an absolute path containing the drive letter like `C:\Some\Folder\Path` - this might prevent the SD card from being enumerated.</span></span>

<span data-ttu-id="1b106-164">Consulte [este vínculo](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) para obtener más información acerca de cómo personalizar la imagen con las entradas del Registro específica.</span><span class="sxs-lookup"><span data-stu-id="1b106-164">See [this link](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) for details about customizing your image with specific registry entries.</span></span>
